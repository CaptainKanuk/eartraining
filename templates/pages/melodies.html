{% extends "base.html" %}

{% block extrahead %}
<!-- Vexflow Libraries -->
<script src="{{ STATIC_URL }}/js/vexflow-debug.js"></script>
<script src="{{ STATIC_URL }}/js/vexflow-min.js"></script>
<script src="{{ STATIC_URL }}/js/interval-names-table.js"></script>
<script src="{{ STATIC_URL }}/js/melodies.js"></script>
<script src="{{ STATIC_URL }}/js/progress-bar.js"></script>
<script src="{{ STATIC_URL }}/js/riffwave.js"></script>
<script src="{{ STATIC_URL }}/js/ajax-functions.js"></script>
<script src="{{ STATIC_URL }}/js/GLOBAL.js"></script>
<script>
  function getMLevel()
  {
    Dajaxice.database.getMelodyLvl(Mlevel_callback, {'text':'{{user.username}}'});
  }
  function incMLevel()
  {
    Dajaxice.database.melodyLvlUp(Mlevel_callback, {'text':'{{user.username}}' });
  }
</script>

<style type="text/css">
    canvas {
        background: #fff;
        padding: 10px;
        border-radius: 8px;
        border: 2px solid #000000;
    }

div.egcode {
    font-family: Courier;
    font-size: 14px;
}
</style>
<script>
    $("canvas").slideToggle("fast");
    function progress(){
        answerChosen = false;
        var button = document.getElementById("start");
        if(button.innerHTML=="Let's start."){
            button.innerHTML="Next Melody.";
            $("canvas").slideToggle("slow");

            getMLevel();
            setTimeout(function(){ getNewMelodies(levToLength(mel_level));}, 100);
            instantiateMelPlay();
        }
        else{
            document.getElementById("play-mel").setAttribute("display", "initial");
            $("canvas").slideToggle("slow", function () {
                document.getElementById(prompt).innerHTML = "Next melody.";
                getMLevel();
                setTimeout(function(){ getNewMelodies(levToLength(mel_level));}, 100);
            });
            $("canvas").slideToggle("slow");
            instantiateMelPlay();
        }
    };
</script>
{% endblock %}


{% block incProgBar %}
</div>
<div class = "row" style="font-weight:bolder">
    <div class="col-md-6">How much HP left?</div>
    <div class="col-md-6" style="float:right;width:40%;margin-right:25px;">
        Progress</br>
        <div class="progress progress-striped active">
            <div id="progress-bar" class="progress-bar progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
                <span class="sr-only">0% Complete</span>
            </div>
        </div>
    </div>
</div>
<div id="row">
{% endblock %}

{% block content %}
</div>
<h1 class="cover-heading">Melodies</h1>
<p class="lead">
<div id="choice">
    <h3 id="prompt" align="center">
        Play and select the correct melody.
    </h3>
    <p id = "play-mel" display = "none" class="lead">
    <a id="mel-play" onclick="playMelody(); melcount++; deactivateMelPlay();" class="btn btn-lg btn-default">Play melody.</a>
    </p>
    <div class="row">
		<div class="col-md-6">
            <canvas id="choice_one" onclick="chooseAnswerMel('choice_one')" width="440" height="100"
                style="border:4px solid #000000;display:none;">
                <script>
                    setup("choice_one");
                    </script>
            </canvas>
        </div>
		<div class="col-md-6">
            <canvas id="choice_two" onclick="chooseAnswerMel('choice_two')" width="440" height="100"
                style="border:4px solid #000000;display:none;">
                <script>
                    setup("choice_two");
                    </script>
            </canvas>
        </div>
    </div>
    <div class="row">
		<div class="col-md-6">
            <canvas id="choice_three" onclick="chooseAnswerMel('choice_three')" width="440" height="100"
                style="border:4px solid #000000;display:none;">
                <script>
                    setup("choice_three");
                    </script>
            </canvas>
        </div>
		<div class="col-md-6">
            <canvas id="choice_four" onclick="chooseAnswerMel('choice_four')" width="440" height="100"
                style="border:4px solid #000000;display:none;">
                <script>
                    setup("choice_four");
                    </script>
            </canvas>
        </div>
    </div>
    
</div>
<p class="lead">
<a href="#" id="start" onclick="melcount = 0; progress();" class="btn btn-lg btn-default">Let's start.</a>
</p>
{% endblock %}

{% block footer %}
{% endblock %}
